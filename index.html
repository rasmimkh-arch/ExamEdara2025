<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ŸÜÿ∏ÿßŸÖ ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿßŸÖÿ™ÿ≠ÿßŸÜÿßÿ™</title>

    <!-- React + Tailwind (ŸÉŸÖÿß ŸÅŸä ÿßŸÑŸÜÿ≥ÿÆÿ© ÿßŸÑÿ≥ÿßÿ®ŸÇÿ©) -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Firebase (compat) - ŸÜÿ≥ÿ™ÿÆÿØŸÖ ŸÜÿ≥ÿÆÿ© compat ŸÑÿ™ÿ≥ŸáŸäŸÑ ÿßŸÑŸÉŸàÿØ -->
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>

    <style>
        * { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            -webkit-tap-highlight-color: transparent;
        }
        body {
            overflow-x: hidden;
        }
        @media (max-width: 768px) {
            .mobile-text-sm { font-size: 0.875rem; }
            .mobile-p-3 { padding: 0.75rem; }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // ----- ÿ£ŸäŸÇŸàŸÜÿßÿ™ ÿ®ÿ≥Ÿäÿ∑ÿ© -----
        const Send = () => <span>üì§</span>;
        const Users = () => <span>üë•</span>;
        const Clock = () => <span>‚è∞</span>;
        const AlertCircle = () => <span>‚ö†Ô∏è</span>;
        const CheckCircle = () => <span>‚úÖ</span>;
        const Bell = () => <span>üîî</span>;

        // ---------------------------
        // ÿ•ÿπÿØÿßÿØ Firebase ‚Äî ŸáŸÜÿß ÿ™ŸÖ ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑŸÉŸàÿØ ÿßŸÑÿ∞Ÿä ÿ£ÿ±ÿ≥ŸÑÿ™ŸéŸá
        // ---------------------------
        const firebaseConfig = {
          apiKey: "AIzaSyBF9s0UgAlbl2swjhjQX4wZ3SJXuQ1CccI",
          authDomain: "examedara.firebaseapp.com",
          projectId: "examedara",
          storageBucket: "examedara.firebasestorage.app",
          messagingSenderId: "1036021370726",
          appId: "1:1036021370726:web:d56497f745f295fbdb02a7"
        };

        // Initialize Firebase (compat)
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // ---------------------------
        // ÿ™ÿ∑ÿ®ŸäŸÇ React ŸÖÿπ Firestore (real-time)
        // ---------------------------
        const ExamManagementSystem = () => {
            const [mode, setMode] = useState('committee');
            const [selectedCommittee, setSelectedCommittee] = useState(1);
            const [reports, setReports] = useState([]);
            const [studentsMap, setStudentsMap] = useState({}); // { committee_1: { absent:[], late:[], present:[] }, ... }
            const [reportText, setReportText] = useState('');
            const [studentName, setStudentName] = useState('');
            const [playSound, setPlaySound] = useState(false);
            const [audioInterval, setAudioInterval] = useState(null);

            // ÿßÿ≥ÿ™ŸÖÿπ ŸÑŸÑÿ™ÿ∫ŸäŸäÿ±ÿßÿ™ ŸÅŸä ŸÖÿ¨ŸÖŸàÿπÿ© ÿßŸÑÿ®ŸÑÿßÿ∫ÿßÿ™ (ÿ™ÿ±ÿ™Ÿäÿ® ÿ≤ŸÖŸÜŸä ÿ™ŸÜÿßÿ≤ŸÑŸä)
            useEffect(() => {
                const q = db.collection('reports').orderBy('timestamp', 'desc');
                const unsubscribe = q.onSnapshot(snapshot => {
                    const arr = [];
                    snapshot.forEach(doc => {
                        arr.push({ id: doc.id, ...doc.data() });
                    });
                    setReports(arr);
                }, err => {
                    console.error('Firestore reports listener error:', err);
                });

                return () => unsubscribe();
            }, []);

            // ÿßÿ≥ÿ™ŸÖÿπ ŸÑŸÑÿ™ÿ∫ŸäŸäÿ±ÿßÿ™ ŸÅŸä ŸÖÿ≥ÿ™ŸÜÿØÿßÿ™ ÿßŸÑŸÑÿ¨ÿßŸÜ
            useEffect(() => {
                const col = db.collection('committees');
                const unsubscribe = col.onSnapshot(snapshot => {
                    const map = {};
                    snapshot.forEach(doc => {
                        map[doc.id] = doc.data();
                    });
                    setStudentsMap(map);
                }, err => {
                    console.error('Firestore committees listener error:', err);
                });

                return () => unsubscribe();
            }, []);

            // ÿµŸàÿ™ ÿßŸÑÿ™ŸÜÿ®ŸäŸá ÿπŸÜÿØ Ÿàÿ¨ŸàÿØ ÿ®ŸÑÿßÿ∫ ÿ¨ÿØŸäÿØ ‚Äî ŸÜÿ±ÿßŸÇÿ® reports ÿ∫Ÿäÿ± ÿßŸÑŸÖŸÇÿ±Ÿàÿ°ÿ©
            useEffect(() => {
                const unreadCount = reports.filter(r => !r.read).length;
                if (unreadCount > 0 && mode === 'control') {
                    setPlaySound(true);
                } else {
                    setPlaySound(false);
                }
            }, [reports, mode]);

            useEffect(() => {
                if (playSound && mode === 'control') {
                    const playAlertSound = () => {
                        const audio = new Audio('data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBTGH0fPTgjMGHm7A7+OZURE');
                        audio.play().catch(() => {});
                    };
                    playAlertSound();
                    const interval = setInterval(playAlertSound, 3000);
                    setAudioInterval(interval);
                    return () => { if (interval) clearInterval(interval); };
                } else {
                    if (audioInterval) {
                        clearInterval(audioInterval);
                        setAudioInterval(null);
                    }
                }
            }, [playSound, mode]);

            // ŸÖÿ≥ÿßÿπÿØÿ©: ÿ¨ŸÑÿ® ÿ®ŸäÿßŸÜÿßÿ™ ŸÑÿ¨ŸÜÿ© ŸÖÿπŸäŸëŸÜÿ© ŸÖŸÜ studentsMap
            const committeeKey = `committee_${selectedCommittee}`;
            const committeeStudents = studentsMap[committeeKey] || { absent: [], late: [], present: [] };

            // ÿ•ÿ±ÿ≥ÿßŸÑ ÿ®ŸÑÿßÿ∫ ‚Üí ÿ•ÿ∂ÿßŸÅÿ© ŸÖÿ≥ÿ™ŸÜÿØ ÿ¨ÿØŸäÿØ ŸÅŸä ŸÖÿ¨ŸÖŸàÿπÿ© "reports"
            const sendReport = async () => {
                if (!reportText.trim()) {
                    alert('ÿßŸÑÿ±ÿ¨ÿßÿ° ŸÉÿ™ÿßÿ®ÿ© ŸÜÿµ ÿßŸÑÿ®ŸÑÿßÿ∫');
                    return;
                }
                try {
                    await db.collection('reports').add({
                        committee: selectedCommittee,
                        text: reportText.trim(),
                        read: false,
                        timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                        createdByClientTime: new Date().toLocaleString('ar-SA')
                    });
                    setReportText('');
                    alert('ÿ™ŸÖ ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿ®ŸÑÿßÿ∫ ÿ®ŸÜÿ¨ÿßÿ≠');
                } catch (err) {
                    console.error('ÿÆÿ∑ÿ£ ÿπŸÜÿØ ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿ®ŸÑÿßÿ∫:', err);
                    alert('ŸÅÿ¥ŸÑ ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿ®ŸÑÿßÿ∫. ÿ±ÿßÿ¨ÿπ ÿßÿ™ÿµÿßŸÑ ÿßŸÑÿ•ŸÜÿ™ÿ±ŸÜÿ™ ÿ£Ÿà ŸÇŸÖ ÿ®ÿ™ÿ¨ÿ±ÿ®ÿ© ÿ´ÿßŸÜŸäÿ©.');
                }
            };

            // ÿ™ÿ≥ÿ¨ŸäŸÑ ÿ∑ÿßŸÑÿ® ÿ∫ÿßÿ¶ÿ® ÿ£Ÿà ŸÖÿ™ÿ£ÿÆÿ±: ŸÜÿ≥ÿ™ÿÆÿØŸÖ ŸÖÿ≥ÿ™ŸÜÿØ ŸÑŸÉŸÑ ŸÑÿ¨ŸÜÿ© ŸÅŸä ŸÖÿ¨ŸÖŸàÿπÿ© "committees"
            const addAbsentStudent = async () => {
                if (!studentName.trim()) {
                    alert('ÿßŸÑÿ±ÿ¨ÿßÿ° ÿ•ÿØÿÆÿßŸÑ ÿßÿ≥ŸÖ ÿßŸÑÿ∑ÿßŸÑÿ®');
                    return;
                }
                const studentObj = {
                    id: Date.now().toString(),
                    name: studentName.trim(),
                    time: new Date().toLocaleString('ar-SA')
                };
                const docRef = db.collection('committees').doc(committeeKey);
                try {
                    await docRef.set({
                        absent: firebase.firestore.FieldValue.arrayUnion(studentObj)
                    }, { merge: true });

                    // ÿ•ÿ∂ÿßŸÅÿ© ÿ®ŸÑÿßÿ∫ ÿ™ŸÑŸÇÿßÿ¶Ÿä
                    await db.collection('reports').add({
                        committee: selectedCommittee,
                        text: `ÿ™ÿ≥ÿ¨ŸäŸÑ ÿ∑ÿßŸÑÿ® ÿ∫ÿßÿ¶ÿ®: ${studentObj.name}`,
                        read: false,
                        timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                        createdByClientTime: new Date().toLocaleString('ar-SA')
                    });

                    setStudentName('');
                    alert('ÿ™ŸÖ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿ∑ÿßŸÑÿ® ÿ∫ÿßÿ¶ÿ®Ÿãÿß');
                } catch (err) {
                    console.error('ÿÆÿ∑ÿ£ ŸÅŸä ÿ•ÿ∂ÿßŸÅÿ© ÿ∑ÿßŸÑÿ® ÿ∫ÿßÿ¶ÿ®:', err);
                    alert('ŸÅÿ¥ŸÑ ÿßŸÑÿ™ÿ≥ÿ¨ŸäŸÑ. ÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿßŸÑÿßÿ™ÿµÿßŸÑ.');
                }
            };

            const addLateStudent = async () => {
                if (!studentName.trim()) {
                    alert('ÿßŸÑÿ±ÿ¨ÿßÿ° ÿ•ÿØÿÆÿßŸÑ ÿßÿ≥ŸÖ ÿßŸÑÿ∑ÿßŸÑÿ®');
                    return;
                }
                const studentObj = {
                    id: Date.now().toString(),
                    name: studentName.trim(),
                    time: new Date().toLocaleString('ar-SA')
                };
                const docRef = db.collection('committees').doc(committeeKey);
                try {
                    await docRef.set({
                        late: firebase.firestore.FieldValue.arrayUnion(studentObj)
                    }, { merge: true });

                    await db.collection('reports').add({
                        committee: selectedCommittee,
                        text: `ÿ™ÿ≥ÿ¨ŸäŸÑ ÿ∑ÿßŸÑÿ® ŸÖÿ™ÿ£ÿÆÿ±: ${studentObj.name}`,
                        read: false,
                        timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                        createdByClientTime: new Date().toLocaleString('ar-SA')
                    });

                    setStudentName('');
                    alert('ÿ™ŸÖ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿ∑ÿßŸÑÿ® ŸÖÿ™ÿ£ÿÆÿ±Ÿãÿß');
                } catch (err) {
                    console.error('ÿÆÿ∑ÿ£ ŸÅŸä ÿ•ÿ∂ÿßŸÅÿ© ÿ∑ÿßŸÑÿ® ŸÖÿ™ÿ£ÿÆÿ±:', err);
                    alert('ŸÅÿ¥ŸÑ ÿßŸÑÿ™ÿ≥ÿ¨ŸäŸÑ. ÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿßŸÑÿßÿ™ÿµÿßŸÑ.');
                }
            };

            // ŸÜŸÇŸÑ ÿ∑ÿßŸÑÿ® ŸÖŸÜ ŸÖÿ™ÿ£ÿÆÿ± ÿ•ŸÑŸâ ÿ≠ÿßÿ∂ÿ± (ŸÜÿ≤ŸäŸÑŸá ŸÖŸÜ ŸÖÿµŸÅŸàŸÅÿ© "late" ŸàŸÜÿ∂ŸäŸÅŸá ÿ•ŸÑŸâ "present")
            const markLateStudentPresent = async (student) => {
                const docRef = db.collection('committees').doc(committeeKey);
                try {
                    // ÿ•ÿ≤ÿßŸÑÿ© ŸÖŸÜ late
                    await docRef.update({
                        late: firebase.firestore.FieldValue.arrayRemove(student)
                    });
                    // ÿ•ÿ∂ÿßŸÅÿ© ÿ•ŸÑŸâ present (ŸÜÿ∂ŸäŸÅ ÿ≠ŸÇŸÑ arrivalTime)
                    const presentObj = { ...student, arrivalTime: new Date().toLocaleString('ar-SA') };
                    await docRef.update({
                        present: firebase.firestore.FieldValue.arrayUnion(presentObj)
                    });

                    // ÿ®ŸÑÿßÿ∫ ÿ™ŸÑŸÇÿßÿ¶Ÿä
                    await db.collection('reports').add({
                        committee: selectedCommittee,
                        text: `ÿ≠ÿ∂ÿ± ÿßŸÑÿ∑ÿßŸÑÿ® ÿßŸÑŸÖÿ™ÿ£ÿÆÿ±: ${student.name}`,
                        read: false,
                        timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                        createdByClientTime: new Date().toLocaleString('ar-SA')
                    });

                    setPlaySound(true);
                } catch (err) {
                    console.error('ÿÆÿ∑ÿ£ ÿπŸÜÿØ ÿ™ÿ≠ŸàŸäŸÑ ÿßŸÑÿ∑ÿßŸÑÿ® ÿ•ŸÑŸâ ÿ≠ÿßÿ∂ÿ±:', err);
                    alert('ŸÅÿ¥ŸÑ ÿßŸÑÿπŸÖŸÑŸäÿ©. ÿ≠ÿßŸàŸÑ ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ.');
                }
            };

            // Ÿàÿ∂ÿπ ÿπŸÑÿßŸÖÿ© "ŸÖŸÇÿ±Ÿàÿ°" ÿπŸÑŸâ ÿ®ŸÑÿßÿ∫
            const markAsRead = async (reportId) => {
                try {
                    await db.collection('reports').doc(reportId).update({ read: true });
                } catch (err) {
                    console.error('ÿÆÿ∑ÿ£ ÿπŸÜÿØ Ÿàÿ≥ŸÖ ÿßŸÑÿ®ŸÑÿßÿ∫ ŸÉŸÖŸÇÿ±Ÿàÿ°:', err);
                }
            };

            // ÿßŸÑÿ≠ÿµŸàŸÑ ÿπŸÑŸâ ÿπÿØÿØ ÿßŸÑÿ®ŸÑÿßÿ∫ÿßÿ™ ÿ∫Ÿäÿ± ÿßŸÑŸÖŸÇÿ±Ÿàÿ°ÿ©
            const unreadCount = reports.filter(r => !r.read).length;

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-2 sm:p-4">
                    <div className="max-w-6xl mx-auto">
                        <div className="bg-white rounded-lg shadow-lg p-3 sm:p-6 mb-4 sm:mb-6">
                            <h1 className="text-xl sm:text-3xl font-bold text-center text-gray-800 mb-2 sm:mb-4">
                                ŸÜÿ∏ÿßŸÖ ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿßŸÖÿ™ÿ≠ÿßŸÜÿßÿ™ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä
                            </h1>
                            <p className="text-center text-gray-600 mb-3 sm:mb-4 text-xs sm:text-sm">
                                üìÖ ÿßŸÑÿ™ÿßÿ±ŸäÿÆ: {new Date().toLocaleDateString('ar-SA')} | 
                                ‚ö†Ô∏è Ÿäÿ™ŸÖ ÿ≠ŸÅÿ∏ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿπŸÑŸâ ÿßŸÑÿ≥ÿ≠ÿßÿ®ÿ© (Firebase) Ÿàÿ™ÿ∏Ÿáÿ± ŸÑÿ¨ŸÖŸäÿπ ÿßŸÑÿ£ÿ¨Ÿáÿ≤ÿ© ŸÅŸàÿ±Ÿãÿß
                            </p>
                            <div className="flex flex-col sm:flex-row gap-2 sm:gap-4 justify-center">
                                <button
                                    onClick={() => setMode('committee')}
                                    className={`w-full sm:w-auto px-4 sm:px-6 py-2 sm:py-3 rounded-lg font-semibold transition text-sm sm:text-base ${
                                        mode === 'committee'
                                            ? 'bg-blue-600 text-white'
                                            : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                                    }`}
                                >
                                    Ÿàÿßÿ¨Ÿáÿ© ÿßŸÑŸÑÿ¨ŸÜÿ©
                                </button>
                                <button
                                    onClick={() => setMode('control')}
                                    className={`w-full sm:w-auto px-4 sm:px-6 py-2 sm:py-3 rounded-lg font-semibold transition text-sm sm:text-base ${
                                        mode === 'control'
                                            ? 'bg-blue-600 text-white'
                                            : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                                    }`}
                                >
                                    ÿ∫ÿ±ŸÅÿ© ÿßŸÑÿ™ÿ≠ŸÉŸÖ
                                </button>
                            </div>
                        </div>

                        {mode === 'committee' ? (
                            <div className="space-y-4 sm:space-y-6">
                                <div className="bg-white rounded-lg shadow-md p-4 sm:p-6">
                                    <label className="block text-base sm:text-lg font-semibold mb-2 sm:mb-3 text-gray-700">
                                        ÿßÿÆÿ™ÿ± ÿ±ŸÇŸÖ ÿßŸÑŸÑÿ¨ŸÜÿ©:
                                    </label>
                                    <select 
                                        value={selectedCommittee}
                                        onChange={(e) => setSelectedCommittee(Number(e.target.value))}
                                        className="w-full p-2 sm:p-3 border-2 border-blue-300 rounded-lg text-base sm:text-lg focus:outline-none focus:border-blue-500"
                                    >
                                        {[...Array(15)].map((_, i) => (
                                            <option key={i + 1} value={i + 1}>ŸÑÿ¨ŸÜÿ© {i + 1}</option>
                                        ))}
                                    </select>
                                </div>

                                <div className="bg-white rounded-lg shadow-md p-4 sm:p-6">
                                    <h3 className="text-lg sm:text-xl font-bold mb-3 sm:mb-4 text-gray-800 flex items-center gap-2">
                                        <Send />
                                        ÿ•ÿ±ÿ≥ÿßŸÑ ÿ®ŸÑÿßÿ∫
                                    </h3>
                                    <textarea
                                        value={reportText}
                                        onChange={(e) => setReportText(e.target.value)}
                                        placeholder="ÿßŸÉÿ™ÿ® ÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑÿ®ŸÑÿßÿ∫ ŸáŸÜÿß..."
                                        className="w-full p-2 sm:p-3 border-2 border-gray-300 rounded-lg mb-3 h-24 sm:h-32 focus:outline-none focus:border-blue-500 resize-y text-sm sm:text-base"
                                    />
                                    <button
                                        onClick={sendReport}
                                        className="w-full bg-blue-600 text-white py-2 sm:py-3 rounded-lg font-semibold hover:bg-blue-700 transition flex items-center justify-center gap-2 text-sm sm:text-base"
                                    >
                                        <Send />
                                        ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿ®ŸÑÿßÿ∫
                                    </button>
                                </div>

                                <div className="bg-white rounded-lg shadow-md p-4 sm:p-6">
                                    <h3 className="text-lg sm:text-xl font-bold mb-3 sm:mb-4 text-gray-800 flex items-center gap-2">
                                        <Users />
                                        ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿ∑ŸÑÿ®ÿ©
                                    </h3>
                                    <input
                                        type="text"
                                        value={studentName}
                                        onChange={(e) => setStudentName(e.target.value)}
                                        placeholder="ÿßÿ≥ŸÖ ÿßŸÑÿ∑ÿßŸÑÿ®"
                                        className="w-full p-2 sm:p-3 border-2 border-gray-300 rounded-lg mb-3 focus:outline-none focus:border-green-500 text-sm sm:text-base"
                                    />
                                    <div className="flex gap-2 sm:gap-3">
                                        <button
                                            onClick={addAbsentStudent}
                                            className="flex-1 bg-red-600 text-white py-2 sm:py-3 rounded-lg font-semibold hover:bg-red-700 transition text-sm sm:text-base"
                                        >
                                            ÿ∫ÿßÿ¶ÿ®
                                        </button>
                                        <button
                                            onClick={addLateStudent}
                                            className="flex-1 bg-yellow-600 text-white py-2 sm:py-3 rounded-lg font-semibold hover:bg-yellow-700 transition text-sm sm:text-base"
                                        >
                                            ŸÖÿ™ÿ£ÿÆÿ±
                                        </button>
                                    </div>
                                </div>

                                {committeeStudents.late && committeeStudents.late.length > 0 && (
                                    <div className="bg-white rounded-lg shadow-md p-4 sm:p-6">
                                        <h3 className="text-lg sm:text-xl font-bold mb-3 sm:mb-4 text-gray-800 flex items-center gap-2">
                                            <Clock />
                                            ÿßŸÑÿ∑ŸÑÿ®ÿ© ÿßŸÑŸÖÿ™ÿ£ÿÆÿ±ŸäŸÜ
                                        </h3>
                                        {committeeStudents.late.map(student => (
                                            <div key={student.id} className="flex flex-col sm:flex-row items-start sm:items-center justify-between p-2 sm:p-3 bg-yellow-50 rounded-lg mb-2 gap-2">
                                                <div className="w-full sm:w-auto">
                                                    <p className="font-semibold text-sm sm:text-base">{student.name}</p>
                                                    <p className="text-xs sm:text-sm text-gray-600">{student.time}</p>
                                                </div>
                                                <button
                                                    onClick={() => markLateStudentPresent(student)}
                                                    className="w-full sm:w-auto bg-green-600 text-white px-3 sm:px-4 py-1.5 sm:py-2 rounded-lg hover:bg-green-700 transition flex items-center justify-center gap-2 text-sm sm:text-base"
                                                >
                                                    <CheckCircle />
                                                    ÿ≠ÿ∂ÿ±
                                                </button>
                                            </div>
                                        ))}
                                    </div>
                                )}

                                <div className="grid grid-cols-3 gap-2 sm:gap-4">
                                    <div className="bg-red-100 p-3 sm:p-4 rounded-lg text-center">
                                        <p className="text-2xl sm:text-3xl font-bold text-red-700">{(committeeStudents.absent || []).length}</p>
                                        <p className="text-xs sm:text-sm text-red-600">ÿ∫ÿßÿ¶ÿ®</p>
                                    </div>
                                    <div className="bg-yellow-100 p-3 sm:p-4 rounded-lg text-center">
                                        <p className="text-2xl sm:text-3xl font-bold text-yellow-700">{(committeeStudents.late || []).length}</p>
                                        <p className="text-xs sm:text-sm text-yellow-600">ŸÖÿ™ÿ£ÿÆÿ±</p>
                                    </div>
                                    <div className="bg-green-100 p-3 sm:p-4 rounded-lg text-center">
                                        <p className="text-2xl sm:text-3xl font-bold text-green-700">{(committeeStudents.present || []).length}</p>
                                        <p className="text-xs sm:text-sm text-green-600">ÿ≠ÿ∂ÿ±</p>
                                    </div>
                                </div>
                            </div>
                        ) : (
                            <div className="space-y-4 sm:space-y-6">
                                <div className="bg-white rounded-lg shadow-md p-4 sm:p-6">
                                    <div className="flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 gap-2">
                                        <h3 className="text-xl sm:text-2xl font-bold text-gray-800 flex items-center gap-2">
                                            <Bell />
                                            ÿßŸÑÿ®ŸÑÿßÿ∫ÿßÿ™ ÿßŸÑŸàÿßÿ±ÿØÿ©
                                        </h3>
                                        <div className="flex items-center gap-2 flex-wrap">
                                            {unreadCount > 0 && (
                                                <span className="bg-red-600 text-white px-3 sm:px-4 py-1 sm:py-2 rounded-full font-bold animate-pulse text-xs sm:text-base">
                                                    {unreadCount} ÿ¨ÿØŸäÿØ
                                                </span>
                                            )}
                                            {playSound && (
                                                <span className="bg-green-600 text-white px-3 sm:px-4 py-1 sm:py-2 rounded-full font-bold animate-pulse text-xs sm:text-base">
                                                    üîä ÿµŸàÿ™ ÿßŸÑÿ™ŸÜÿ®ŸäŸá ŸÜÿ¥ÿ∑
                                                </span>
                                            )}
                                        </div>
                                    </div>

                                    {reports.length === 0 ? (
                                        <p className="text-center text-gray-500 py-6 sm:py-8 text-sm sm:text-base">ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ®ŸÑÿßÿ∫ÿßÿ™</p>
                                    ) : (
                                        <div className="space-y-2 sm:space-y-3">
                                            {reports.map(report => (
                                                <div 
                                                    key={report.id}
                                                    className={`p-3 sm:p-4 rounded-lg border-r-4 cursor-pointer ${
                                                        report.read 
                                                            ? 'bg-gray-50 border-gray-400' 
                                                            : 'bg-blue-50 border-blue-600'
                                                    }`}
                                                    onClick={() => markAsRead(report.id)}
                                                >
                                                    <div className="flex flex-col sm:flex-row items-start sm:items-start justify-between mb-2 gap-1 sm:gap-0">
                                                        <div className="flex items-center gap-2">
                                                            <span className="bg-blue-600 text-white px-2 sm:px-3 py-0.5 sm:py-1 rounded-full text-xs sm:text-sm font-bold">
                                                                ŸÑÿ¨ŸÜÿ© {report.committee}
                                                            </span>
                                                            {!report.read && <AlertCircle />}
                                                        </div>
                                                        <span className="text-xs sm:text-sm text-gray-600">{report.createdByClientTime || ''}</span>
                                                    </div>
                                                    <p className="text-gray-800 font-medium whitespace-pre-wrap text-sm sm:text-base">{report.text}</p>
                                                </div>
                                            ))}
                                        </div>
                                    )}
                                </div>

                                <div className="bg-white rounded-lg shadow-md p-4 sm:p-6">
                                    <h3 className="text-lg sm:text-xl font-bold mb-3 sm:mb-4 text-gray-800">ŸÖŸÑÿÆÿµ ÿ¨ŸÖŸäÿπ ÿßŸÑŸÑÿ¨ÿßŸÜ</h3>
                                    <div className="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-3 gap-2 sm:gap-4">
                                        {[...Array(15)].map((_, i) => {
                                            const key2 = `committee_${i + 1}`;
                                            const data = studentsMap[key2] || { absent: [], late: [], present: [] };
                                            return (
                                                <div key={i} className="border-2 border-gray-200 rounded-lg p-2 sm:p-4">
                                                    <h4 className="font-bold text-center mb-2 sm:mb-3 text-blue-600 text-sm sm:text-base">ŸÑÿ¨ŸÜÿ© {i + 1}</h4>
                                                    <div className="space-y-1 sm:space-y-2 text-xs sm:text-sm">
                                                        <div className="flex justify-between">
                                                            <span>ÿ∫ÿßÿ¶ÿ®:</span>
                                                            <span className="font-bold text-red-600">{(data.absent || []).length}</span>
                                                        </div>
                                                        <div className="flex justify-between">
                                                            <span>ŸÖÿ™ÿ£ÿÆÿ±:</span>
                                                            <span className="font-bold text-yellow-600">{(data.late || []).length}</span>
                                                        </div>
                                                        <div className="flex justify-between">
                                                            <span>ÿ≠ÿ∂ÿ±:</span>
                                                            <span className="font-bold text-green-600">{(data.present || []).length}</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            );
                                        })}
                                    </div>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        ReactDOM.render(<ExamManagementSystem />, document.getElementById('root'));
    </script>
</body>
</html>
